# 天圆地方 GeoCraft

天圆地方（GeoCraft）是一个致力于将地理要素融合进Minecraft的模组，目前仅支持Minecraft Java 1.12.2，基于Forge。模组在保证尽可能不添加新方块、物品等要素的情况下，尽一切可能通过修改游戏机制，使Minecraft世界更加符合真实世界，将真正的地理带入Minecraft。

该模组仍然处于早期开发中，功能尚不全面，且不保证能够稳定运行。如遇bug，欢迎在上方提个Issue，记得附上日志捏～

模组已实现的主要内容有：

- 真正的流体物理
- 一个完善的大气系统
- 水循环（部分实现）

期望会在未来实现的功能有：

- 地质作用

另外，模组拥有高度可配置的配置文件，并提供了功能丰富的API，供其他第三方模组实现更多更好的功能。

## 流体物理

模组对原版流体系统进行了大改。并提供了两种流体物理实现方式。对于默认实现方式（MORE_PHYSICS）：

- 每块流体都是真实且有限的
- 流体在水平面上会向四周摊开
- 流体会向低处流动
- 密度高的流体会移动到密度低的流体下方

类原版（VANILLA_LIKE）流体物理实现方式可以在配置文件中手动切换，请注意该模式并不推荐，因为其缺乏了很多有趣的功能。该实现方式提供：

- 流体会在可能的情况下向下流动
- 在水平面上会保持原版的行为
- 密度高的流体会移动到密度低的流体下方

模组还实现了水循环的模拟：

|         功能         |                                                   支持程度                                                    |
| :------------------: | :-----------------------------------------------------------------------------------------------------------: |
|       地表径流       |                                                开启水物理就有                                                 |
|       水会蒸发       |                      水会真正被蒸发：MORE_PHYSICS<br/>水不会消失：VANILLA_LIKE、VANILLA                       |
|     大气水汽输送     |                                                    均支持                                                     |
| 下雨时水会降落到地面 | 降雨精确到层：MORE_PHYSICS、VANILLA_LIKE（仅降雪）<br/>降雨精确到方块：VANILLA_LIKE<br/>不会真正降雨：VANILLA |
|       水会下渗       |                           完全支持：MORE_PHYSICS<br/>不支持：VANILLA_LIKE、VANILLA                            |
|      土壤水流动      |                                                    均支持                                                     |
|      土壤水渗漏      |                           完全支持：MORE_PHYSICS<br/>不支持：VANILLA_LIKE、VANILLA                            |
|      土壤水蒸发      |                                                     TODO                                                      |
|     植物蒸腾作用     |                                                     TODO                                                      |

## 大气

模组添加了一个以区块为单位进行拟真的大气系统。该大气系统仅在初始化时会使用生物群系作为参考，其余的模拟过程中大气将会以实际下垫面性质作为参考，这意味着下垫面变化将会引起气候的变化！

大气还实现了物质输送和能量传递，对气温（以及地温）、风、压强、水汽压和云量均有模拟，并计划添加局部天气系统。不同的维度也将会有不同性质的大气。例如，地狱的大气结构会比较简单，温度常年保持恒定，水汽可以在地狱大气中移动。

### 大气刻

大气的更新间隔叫做大气刻。默认1大气刻=60游戏刻，但这并不意味所有大气都是同时更新的。为了提升性能，大气是分布更新，这意味着所有加载中的大气都会被均摊成60份进行更新。即使世界同时有100000个大气加载，一游戏刻更新的大气也仅有大约1666个左右。

### 性质

大气会对游戏世界造成如下影响：

- 气温越高，水汽压越低，水蒸发会越旺盛
- 地温低于0摄氏度时，水会结冰
- 大气水量充沛时，多余的水会降落到地面

更多影响正在TO DO

同样，下垫面性质也会影响大气：

- 下垫面返照率越高，大气升温越慢
- 下垫面有水，比热容会变大，大气温差变小
- 水的相态变化会释放或吸收热量，影响温度
- 下垫面的海拔越高，大气会越稀薄

### 存储和运行

大气的存储和运行独立于区块存储和运行。大气会在每个维度的文件夹DIMx（x为维度ID）下的atmosphere文件夹保存.atmdat文件作为大气数据存储文件。大气的加载范围也会比区块的加载范围更大，且区块卸载并不一定大气会卸载，由此大气可以保证更加真实的大区域气候模拟。

